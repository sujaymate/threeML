<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Working with XSPEC models &mdash; The Multi-Mission Maximum Likelihood framework  documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/sg_gallery.css" type="text/css" />
      <link rel="stylesheet" href="../_static/dark_mode_css/general.css" type="text/css" />
      <link rel="stylesheet" href="../_static/dark_mode_css/dark.css" type="text/css" />
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        <script src="../_static/dark_mode_js/default_dark.js"></script>
        <script src="../_static/dark_mode_js/theme_switcher.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Frequently Asked Questions" href="../faq.html" />
    <link rel="prev" title="Modeling" href="../modeling.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> The Multi-Mission Maximum Likelihood framework
            <img src="../_static/logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../intro.html">Intro</a></li>
<li class="toctree-l1"><a class="reference internal" href="../xspec_users.html">Notes for XSPEC Users</a></li>
<li class="toctree-l1"><a class="reference internal" href="Minimization_tutorial.html">Minimization</a></li>
<li class="toctree-l1"><a class="reference internal" href="Bayesian_tutorial.html">Bayesian Posterior Sampling</a></li>
<li class="toctree-l1"><a class="reference internal" href="sampler_docs.html">Bayesian Sampler Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../plugins.html">Plugins</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../modeling.html">Modeling</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Working with XSPEC models</a></li>
<li class="toctree-l2"><a class="reference internal" href="#XSPEC-Settings">XSPEC Settings</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../faq.html">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/API.html">API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/API.html#threeml">threeML</a></li>
<li class="toctree-l1"><a class="reference internal" href="../release_notes.html">Release Notes</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Features and examples:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Analysis_results_showcase.html">Analysis Results</a></li>
<li class="toctree-l1"><a class="reference internal" href="grb080916C.html">Analyzing GRB 080916C</a></li>
<li class="toctree-l1"><a class="reference internal" href="APEC_doc.html">Fitting XMM-Newton data with the APEC model</a></li>
<li class="toctree-l1"><a class="reference internal" href="joint_BAT_gbm_demo.html">Example joint fit between GBM and Swift BAT</a></li>
<li class="toctree-l1"><a class="reference internal" href="joint_fitting_xrt_and_gbm_xspec_models.html">Joint fitting XRT and GBM data with XSPEC models</a></li>
<li class="toctree-l1"><a class="reference internal" href="Fermipy_LAT.html">Fermi-LAT via FermiPyLike</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">The Multi-Mission Maximum Likelihood framework</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a></li>
          <li class="breadcrumb-item"><a href="../modeling.html">Modeling</a></li>
      <li class="breadcrumb-item active">Working with XSPEC models</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars and line breaks on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
    white-space: pre;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt .copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
.jp-RenderedHTMLCommon table,
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
.jp-RenderedHTMLCommon thead,
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
.jp-RenderedHTMLCommon tr,
.jp-RenderedHTMLCommon th,
.jp-RenderedHTMLCommon td,
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
.jp-RenderedHTMLCommon th,
div.rendered_html th {
  font-weight: bold;
}
.jp-RenderedHTMLCommon tbody tr:nth-child(odd),
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
.jp-RenderedHTMLCommon tbody tr:hover,
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<p>-– jupyter: jupytext: formats: ipynb,md text_representation: extension: .md format_name: markdown format_version: ‘1.2’ jupytext_version: 1.7.1 kernelspec: display_name: Python 3 language: python name: python3 —</p>
<section id="Working-with-XSPEC-models">
<h1>Working with XSPEC models<a class="headerlink" href="#Working-with-XSPEC-models" title="Permalink to this heading"></a></h1>
<p>One of the most powerful aspects of <strong>XSPEC</strong> is a huge modeling community. While in 3ML, we are focused on building a powerful and modular data analysis tool, we cannot neglect the need for many of the models thahat already exist in <strong>XSPEC</strong> and thus provide support for them via <strong>astromodels</strong> directly in 3ML.</p>
<p>For details on installing <strong>astromodels</strong> with <strong>XSPEC</strong> support, visit the 3ML or <strong>astromodels</strong> installation page.</p>
<div class="alert alert-block alert-info"><p>Tip: astromodels / 3ML already have ZDust, absorption and APEC models built in!</p>
</div><p>Let’s explore how we can use <strong>XSPEC</strong> spectral models in 3ML.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>import warnings

warnings.simplefilter(&quot;ignore&quot;)
import numpy as np

np.seterr(all=&quot;ignore&quot;)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{&#39;divide&#39;: &#39;warn&#39;, &#39;over&#39;: &#39;warn&#39;, &#39;under&#39;: &#39;ignore&#39;, &#39;invalid&#39;: &#39;warn&#39;}
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>import matplotlib.pyplot as plt
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>%%capture
from threeML import set_threeML_style
from jupyterthemes import jtplot

%matplotlib inline
jtplot.style(context=&quot;talk&quot;, fscale=1, ticks=True, grid=False)


set_threeML_style()
</pre></div>
</div>
</div>
<p>We do not load the models by default as this takes some time and 3ML should load quickly. However, if you need the <strong>XSPEC</strong> models, they are imported from astromodels like this:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>from astromodels.xspec.factory import *
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Loading xspec models...Generating code for Xspec model agauss...
Generating code for Xspec model agnsed...
Generating code for Xspec model agnslim...
Generating code for Xspec model apec...
Generating code for Xspec model bapec...
Generating code for Xspec model btapec...
Generating code for Xspec model bbody...
Generating code for Xspec model bbodyrad...
Generating code for Xspec model bexrav...
Generating code for Xspec model bexriv...
Generating code for Xspec model bknpower...
Generating code for Xspec model bkn2pow...
Generating code for Xspec model bmc...
Generating code for Xspec model bremss...
Generating code for Xspec model brnei...
Generating code for Xspec model bvapec...
Generating code for Xspec model bvrnei...
Generating code for Xspec model bvtapec...
Generating code for Xspec model bvvapec...
Generating code for Xspec model bvvrnei...
Generating code for Xspec model bvvtapec...
Generating code for Xspec model c6mekl...
Generating code for Xspec model c6pmekl...
Generating code for Xspec model c6pvmkl...
Generating code for Xspec model c6vmekl...
Generating code for Xspec model carbatm...
Generating code for Xspec model cemekl...
Generating code for Xspec model cevmkl...
Generating code for Xspec model cflow...
Generating code for Xspec model compbb...
Generating code for Xspec model compLS...
Generating code for Xspec model compPS...
Generating code for Xspec model compST...
Generating code for Xspec model compth...
Generating code for Xspec model compTT...
Generating code for Xspec model cph...
Generating code for Xspec model cplinear...
Generating code for Xspec model cutoffpl...
Generating code for Xspec model disk...
Generating code for Xspec model diskir...
Generating code for Xspec model diskbb...
Generating code for Xspec model diskline...
Generating code for Xspec model diskm...
Generating code for Xspec model disko...
Generating code for Xspec model diskpbb...
Generating code for Xspec model diskpn...
Generating code for Xspec model eplogpar...
Generating code for Xspec model eqpair...
Generating code for Xspec model eqtherm...
Generating code for Xspec model equil...
Generating code for Xspec model expdec...
Generating code for Xspec model ezdiskbb...
Generating code for Xspec model gaussian...
Generating code for Xspec model gadem...
Generating code for Xspec model gnei...
Generating code for Xspec model grad...
Generating code for Xspec model grbm...
Generating code for Xspec model hatm...
Generating code for Xspec model jet...
Generating code for Xspec model kerrbb...
Generating code for Xspec model kerrd...
Generating code for Xspec model kyrline...
Generating code for Xspec model laor...
Generating code for Xspec model laor2...
Generating code for Xspec model logpar...
Generating code for Xspec model lorentz...
Generating code for Xspec model meka...
Generating code for Xspec model mekal...
Generating code for Xspec model mkcflow...
Generating code for Xspec model nei...
Generating code for Xspec model nlapec...
Generating code for Xspec model npshock...
Generating code for Xspec model nsa...
Generating code for Xspec model nsagrav...
Generating code for Xspec model nsatmos...
Generating code for Xspec model nsmax...
Generating code for Xspec model nsmaxg...
Generating code for Xspec model nsx...
Generating code for Xspec model nteea...
Generating code for Xspec model nthComp...
Generating code for Xspec model optxagn...
Generating code for Xspec model optxagnf...
Generating code for Xspec model pegpwrlw...
Generating code for Xspec model pexmon...
Generating code for Xspec model pexrav...
Generating code for Xspec model pexriv...
Generating code for Xspec model plcabs...
Generating code for Xspec model powerlaw...
Generating code for Xspec model posm...
Generating code for Xspec model pshock...
Generating code for Xspec model qsosed...
Generating code for Xspec model raymond...
Generating code for Xspec model redge...
Generating code for Xspec model refsch...
Generating code for Xspec model rnei...
Generating code for Xspec model sedov...
Generating code for Xspec model sirf...
Generating code for Xspec model snapec...
Generating code for Xspec model srcut...
Generating code for Xspec model sresc...
Generating code for Xspec model ssa...
Generating code for Xspec model step...
Generating code for Xspec model tapec...
Generating code for Xspec model vapec...
Generating code for Xspec model vbremss...
Generating code for Xspec model vcph...
Generating code for Xspec model vequil...
Generating code for Xspec model vgadem...
Generating code for Xspec model vgnei...
Generating code for Xspec model vmeka...
Generating code for Xspec model vmekal...
Generating code for Xspec model vmcflow...
Generating code for Xspec model vnei...
Generating code for Xspec model vnpshock...
Generating code for Xspec model voigt...
Generating code for Xspec model vpshock...
Generating code for Xspec model vraymond...
Generating code for Xspec model vrnei...
Generating code for Xspec model vsedov...
Generating code for Xspec model vtapec...
Generating code for Xspec model vvapec...
Generating code for Xspec model vvgnei...
Generating code for Xspec model vvnei...
Generating code for Xspec model vvnpshock...
Generating code for Xspec model vvpshock...
Generating code for Xspec model vvrnei...
Generating code for Xspec model vvsedov...
Generating code for Xspec model vvtapec...
Generating code for Xspec model vvwdem...
Generating code for Xspec model vwdem...
Generating code for Xspec model wdem...
Generating code for Xspec model zagauss...
Generating code for Xspec model zbbody...
Generating code for Xspec model zbknpower...
Generating code for Xspec model zbremss...
Generating code for Xspec model zcutoffpl...
Generating code for Xspec model zgauss...
Generating code for Xspec model zkerrbb...
Generating code for Xspec model zlogpar...
Generating code for Xspec model zpowerlw...
Generating code for Xspec model absori...
Generating code for Xspec model acisabs...
Generating code for Xspec model constant...
Generating code for Xspec model cabs...
Generating code for Xspec model cyclabs...
Generating code for Xspec model dust...
Generating code for Xspec model edge...
Generating code for Xspec model expabs...
Generating code for Xspec model expfac...
Generating code for Xspec model gabs...
Generating code for Xspec model heilin...
Generating code for Xspec model highecut...
Generating code for Xspec model hrefl...
Generating code for Xspec model logconst...
Generating code for Xspec model log10con...
Generating code for Xspec model lyman...
Generating code for Xspec model notch...
Generating code for Xspec model pcfabs...
Generating code for Xspec model phabs...
Generating code for Xspec model plabs...
Generating code for Xspec model pwab...
Generating code for Xspec model redden...
Generating code for Xspec model smedge...
Generating code for Xspec model spexpcut...
Generating code for Xspec model spline...
Generating code for Xspec model SSS_ice...
Generating code for Xspec model swind1...
Generating code for Xspec model TBabs...
Generating code for Xspec model TBfeo...
Generating code for Xspec model TBgas...
Generating code for Xspec model TBgrain...
Generating code for Xspec model TBvarabs...
Generating code for Xspec model TBpcf...
Generating code for Xspec model TBrel...
Generating code for Xspec model uvred...
Generating code for Xspec model varabs...
Generating code for Xspec model vphabs...
Generating code for Xspec model wabs...
Generating code for Xspec model wndabs...
Generating code for Xspec model xion...
Generating code for Xspec model xscat...
Generating code for Xspec model zdust...
Generating code for Xspec model zedge...
Generating code for Xspec model zhighect...
Generating code for Xspec model zigm...
Generating code for Xspec model zpcfabs...
Generating code for Xspec model zphabs...
Generating code for Xspec model zxipab...
Generating code for Xspec model zxipcf...
Generating code for Xspec model zredden...
Generating code for Xspec model zsmdust...
Generating code for Xspec model zTBabs...
Generating code for Xspec model zvarabs...
Generating code for Xspec model zvfeabs...
Generating code for Xspec model zvphabs...
Generating code for Xspec model zwabs...
Generating code for Xspec model zwndabs...
done
</pre></div></div>
</div>
<p>The models are indexed with <em>XS_</em> before the typical <strong>XSPEC</strong> model names.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>plaw = XS_powerlaw()
phabs = XS_phabs()
phabs
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<ul>

<li>description: The phabs model from XSpec (https://heasarc.gsfc.nasa.gov/xanadu/xspec/manual/XspecModels.html)</li>

<li>formula: $n.a.$</li>

<li>parameters:
<ul>

<li>nh:
<ul>

<li>value: 1.0</li>

<li>desc: (see https://heasarc.gsfc.nasa.gov/xanadu/xspec/manual/XspecModels.html)</li>

<li>min_value: 0.0</li>

<li>max_value: 1000000.0</li>

<li>unit: </li>

<li>is_normalization: False</li>

<li>delta: 0.001</li>

<li>free: True</li>

</ul>

</li>

</ul>

</li>

</ul></div>
</div>
<p>The spectral models behave just as any other <strong>astromodels</strong> spectral model and can be used in combination with other <strong>astromodels</strong> spectral models.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>from astromodels import Powerlaw

am_plaw = Powerlaw()

plaw_with_abs = am_plaw * phabs


fig, ax = plt.subplots()

energy_grid = np.linspace(0.1, 10.0, 1000)

ax.loglog(energy_grid, plaw_with_abs(energy_grid))
ax.set_xlabel(&quot;energy&quot;)
ax.set_ylabel(&quot;flux&quot;)
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Text(0, 0.5, &#39;flux&#39;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_xspec_models_10_1.png" src="../_images/notebooks_xspec_models_10_1.png" />
</div>
</div>
</section>
<section id="XSPEC-Settings">
<h1>XSPEC Settings<a class="headerlink" href="#XSPEC-Settings" title="Permalink to this heading"></a></h1>
<p>Many <strong>XSPEC</strong> models depend on external abundances, cross-sections, and cosmological parameters. We provide an interface to control these directly.</p>
<p>Simply import the <strong>XSPEC</strong> settings like so:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>from astromodels.xspec.xspec_settings import *
</pre></div>
</div>
</div>
<p>Calling the functions without arguments simply returns their current settings</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>xspec_abund()
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&#39;angr&#39;
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>xspec_xsect()
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&#39;vern&#39;
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>xspec_cosmo()
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(70.0, 0.0, 0.7300000190734863)
</pre></div></div>
</div>
<p>To change the settings for abundance and cross-section, provide strings with the normal <strong>XSPEC</strong> naming conventions.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>xspec_abund(&quot;wilm&quot;)
xspec_abund()
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
 Solar Abundance Vector set to wilm:  Wilms, J., Allen, A. &amp; McCray, R. ApJ 542 914 (2000) (abundances are set to zero for those elements not included in the paper).
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&#39;wilm&#39;
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>xspec_xsect(&quot;bcmc&quot;)
xspec_xsect()
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
 Cross Section Table set to bcmc:  Balucinska-Church and McCammon, 1998
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&#39;bcmc&#39;
</pre></div></div>
</div>
<p>To alter the cosmological parameters, one passes either the parameters that should be changed, or all three:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>xspec_cosmo(H0=68.0)
xspec_cosmo()
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(68.0, 0.0, 0.7300000190734863)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>xspec_cosmo(H0=68.0, q0=0.1, lambda_0=70.0)
xspec_cosmo()
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(68.0, 0.10000000149011612, 70.0)
</pre></div></div>
</div>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../modeling.html" class="btn btn-neutral float-left" title="Modeling" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../faq.html" class="btn btn-neutral float-right" title="Frequently Asked Questions" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2017--2021, G.Vianello, J. M. Burgess, N. Di Lalla, N. Omodei, H. Fleischhack.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>